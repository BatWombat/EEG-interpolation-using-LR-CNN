from sklearn.metrics import mean_squared_error

# Load the trained model
model = joblib.load("Implausible_Model.joblib")

# Load the dataset
data = pd.read_csv("Implausible_P600.csv")

# Specify the subject for prediction
trialnum = 53

# Filter the dataset for the specified subject
subject_data = data[data["TrialNum"] == trialnum]

if subject_data.empty:
    print("No data found for subject", subject)
else:
    cols = ["FC1", "FC2", "CP1", "CP2"]
    X = subject_data[cols].values
    y_true = subject_data["Cz"].values
    timestamps = subject_data["Timestamp"].values

    poly = PolynomialFeatures(degree=2)
    X_poly = poly.fit_transform(X)
    y_pred = model.predict(X_poly)

    mse = mean_squared_error(y_true, y_pred)
    print("Mean squared error:", mse)

    plt.plot(timestamps, y_true, label="True values")
    plt.plot(timestamps, y_pred, label="Predicted values")
    plt.xlabel("Timestamp")
    plt.xlim([600, 1000]) 
    plt.ylabel("Cz values")
    plt.legend()
    plt.show()
